REQUISITION自動生成ツール - 開発仕様書
1. プロジェクト概要
1.1 目的
自動車生産関連の設備導入プロジェクトにおける購入要求書（REQUISITION）の作成を半自動化し、以下を実現する：

作成時間の短縮
記載漏れの防止
仕様の標準化・品質向上

1.2 対象ショップ

溶接（Welding）
塗装（Painting）
組立（Assembly）
検査（Inspection）

1.3 使用者

プロジェクトマネージャー
設備担当技術者

2. REQUISITION の構成
2.1 基本構造
REQUISITION = 本体書類（流れ・概要） + 添付資料（詳細データ）
2.2 本体書類の章構成

プロジェクト概要
適用範囲・スコープ
設備仕様（最重要章）

全体レイアウト
ライン構成（フロー図形式）
機器リスト
個別機器性能
メカ配置レイアウト
制御システムダイアグラム
制御機能説明


プロジェクトスケジュール
責任範囲
検収条件
特記事項
組織表（コミュニケーション流れ、責任者）

2.3 添付資料（例）

レイアウト図面（CADから出力）
機器リスト（システム生成）
ガントチャート（別アプリ自動生成）
RASIチャート
電力・動力源取り合い図
検査項目チェックリスト
提出書類一覧

3. ライン構成の定義方法
3.1 グルーピング
REQUISITIONはショップ単位で発行され、通常1つのグルーピングを含む。
グルーピング例：

溶接：Bodysideライン、ドアライン、ルーフライン
塗装：前処理電着ライン、上塗りライン
組立：トリム組立ライン
検査：車検ライン

3.2 工程の定義
各グルーピングは複数の工程から構成される。
工程の構成要素：

工程番号（例：#010、#020、数字のみでも可）
工程名（例：Sidebody、Door）
主機能（例：GEO溶接、RESPOT、検査、ドアセット、ボルト締め、シーリング、レーザーカット）

3.3 機器と機能の関係
例：溶接工程の機能と機器
工程：サブアッセンブリ溶接（#010）
├─ 機能：搬入 → 機器：コンベア
├─ 機能：部品固定 → 機器：溶接治具
├─ 機能：溶接 → 機器：溶接ロボット + 溶接ガン
├─ 機能：シーリング → 機器：シーリング装置
├─ 機能：固定解除 → 機器：（治具の一部）
└─ 機能：搬出 → 機器：ハンドリングロボット
4. 機器種別マスターデータ
4.1 命名規則

英語名の頭文字3文字を基本
アルファベット3文字の略称

4.2 ショップ共通機器
略称機器種別英語名カテゴリCTL制御盤Control Panel電気PWR分電盤Power Panel電気OPR操作盤Operation Panel電気CNVコンベアConveyor搬送MON監視システムMonitor System制御
4.3 溶接ショップ固有機器
略称機器種別英語名カテゴリWRB溶接ロボットWelding RobotロボットWGN溶接ガンWelding GunアクセサリHRBハンドリングロボットHandling RobotロボットJIG溶接治具Jig治具SELシーリング装置Sealing Device専用機POSポジショナーPositioner治具
4.4 塗装ショップ固有機器
略称機器種別英語名カテゴリPRB塗装ロボットPainting RobotロボットBTH塗装ブースBooth専用機OVN乾燥炉Oven専用機PTK前処理槽Pretreatment Tank専用機EDT電着槽Electrodeposition Tank専用機SPYスプレー装置Spray Device専用機
4.5 組立ショップ固有機器
略称機器種別英語名カテゴリARB組立ロボットAssembly RobotロボットNUTナットランナーNutrunner工具LFTリフターLifter搬送TRNターンテーブルTurntable搬送
4.6 検査ショップ固有機器
略称機器種別英語名カテゴリINS検査装置Inspection Device専用機CAMカメラシステムCamera SystemセンサTST試験装置Test Device専用機
4.7 機器種別の拡張方針

ショップ固有の専用機能装置は個別に追加・強化
中規模機器/機能設備（例：大型モーター）の登録判断は使用者に委ねる
部品/コンポーネントレベル（センサー等）は対象外

5. 機器番号採番ルール
5.1 基本ルール

機器種別ごとに独立した連番
プロジェクト内で通し番号
例：WRB-001, WRB-002, WRB-003...、CNV-001, CNV-002...

5.2 採番タイミング

Excelアップロード時にシステムが自動採番
採番後、手動で修正可能

5.3 カスタマイズ可能項目

機器種別略称の追加/変更

プロジェクト固有の機器種別を追加可能


連番開始番号

001ではなく100から開始、など


プレフィックスの追加

例：BS-WRB-001（ラインコード + 機器種別 + 連番）



5.4 採番例
設定：

プレフィックス：BS-
開始番号：001

結果：

BS-WRB-001（溶接ロボット1台目）
BS-WRB-002（溶接ロボット2台目）
BS-WGN-001（溶接ガン1台目）
BS-CNV-001（コンベア1台目）

6. データ入力フォーマット
6.1 Excel入力フォーマット（1シート・フラット方式）
工程番号工程名主機能機器種別機器名称型式/仕様数量メーカー備考010SidebodyGEO溶接WRB溶接ロボットFANUC R-2000iC/165F1FANUC010SidebodyGEO溶接WGN溶接ガンサーボガン X-TYPE1XXX工業010SidebodyGEO溶接HRBハンドリングロボットKUKA KR-2101KUKA020DoorRESPOTWRB溶接ロボットFANUC R-2000iC/125L1FANUC
6.2 必須項目

MUST（必須）：

工程番号
工程名
主機能


推奨：

機器種別
機器名称
型式/仕様
数量
メーカー



6.3 入力ルール

工程番号： 数字のみでOK（010、020）、「#」付きも可（#010、#020）
機器種別： 3文字コードを直接入力（WRB、CNV等）
数量： 基本的に1（同じ工程内の同形式機器も別採番するため）

6.4 バリデーション・エラーハンドリング

不備のある行： スキップして残りをインポート
警告表示： スキップした行を明示的に表示
エラー例：

必須項目（工程番号、工程名、主機能）が空欄
機器種別コードが存在しない



7. フロー図の仕様
7.1 フロー図の形式

ブロックレイアウトまたは簡易フロー図（四角形 + 矢印）
各ブロック = 1工程

7.2 ブロック内の記載内容

工程番号（例：#010、#020）
工程名（例：Sidebody、Door）
主機能（例：GEO溶接、RESPOT）

7.3 フロー図エディタ

推奨： Webベースビジュアルエディタ または mermaid
データ形式： 編集可能な形式（JSON/mermaid記法）
工程番号の対応付け： 手動（フロー図作成時に入力）

7.4 フロー図の例（mermaid記法）
mermaidgraph LR
    A[#010<br/>Sidebody<br/>GEO溶接] --> B[#020<br/>Door<br/>RESPOT]
    B --> C[#030<br/>Roof<br/>検査]
8. データ構造設計
8.1 プロジェクトデータ構造（JSON）
json{
  "project": {
    "basicInfo": {
      "projectId": "PRJ-2025-001",
      "projectName": "XX工場 新車種対応 Bodysideライン",
      "customer": "ABC自動車株式会社",
      "shop": "welding",
      "lineScope": "Bodyside Line",
      "deliveryDate": "2026-03-31",
      "responsiblePM": "山田太郎",
      "createdDate": "2025-10-08"
    },
    "numberingRules": {
      "prefix": "BS-",
      "startNumber": 1,
      "customEquipmentTypes": []
    },
    "processes": [
      {
        "processId": "010",
        "processName": "Sidebody",
        "mainFunction": "GEO溶接",
        "equipmentList": [
          {
            "equipmentType": "WRB",
            "equipmentName": "溶接ロボット",
            "equipmentNumber": "BS-WRB-001",
            "model": "FANUC R-2000iC/165F",
            "quantity": 1,
            "manufacturer": "FANUC",
            "remarks": ""
          }
        ]
      }
    ],
    "flowDiagram": {
      "format": "mermaid",
      "content": "graph LR\n A[#010 Sidebody GEO溶接] --> B[#020 Door RESPOT]",
      "metadata": {
        "createdBy": "設計太郎",
        "createdDate": "2025-10-10"
      }
    }
  }
}
8.2 機器種別マスターデータ構造（JSON）
json{
  "equipmentTypes": {
    "common": [
      {
        "code": "CTL",
        "name": "制御盤",
        "nameEn": "Control Panel",
        "category": "電気"
      }
    ],
    "welding": [
      {
        "code": "WRB",
        "name": "溶接ロボット",
        "nameEn": "Welding Robot",
        "category": "ロボット"
      }
    ],
    "painting": [],
    "assembly": [],
    "inspection": []
  }
}
9. Phase 1 MVP 実装仕様
9.1 実装形態

Webアプリケーション（ブラウザで動作）
フレームワーク： React
データ永続化： 推奨案に従う（ブラウザローカルストレージまたはサーバーDB）

9.2 実装する機能（優先順）
9.2.1 プロジェクト基本情報入力フォーム

プロジェクトID（自動生成）
プロジェクト名
顧客名
ショップ種別（溶接/塗装/組立/検査）
ライン名称
納期
担当PM

9.2.2 Excelテンプレートダウンロード機能

定義されたフォーマットのExcelファイルを生成・ダウンロード

9.2.3 Excelアップロード＆解析

ファイル選択またはドラッグ&ドロップ
SheetJS (xlsx)を使用してExcel解析
Papa Parseでデータ検証

9.2.4 機器番号自動採番ロジック

プレフィックス設定
開始番号設定
機器種別ごとに独立した連番生成
採番後の手動編集機能

9.2.5 機器リスト表示＆編集UI

テーブル形式で表示
各行の編集機能
機器番号の手動修正
データのソート・フィルタリング

9.2.6 mermaidフロー図エディタ

mermaid記法の入力エリア
リアルタイムプレビュー
工程番号の手動入力

9.2.7 簡易REQUISITION生成（HTML/Markdown）

プロジェクト情報 + 機器リスト + フロー図を統合
HTML/Markdown形式で出力
プレビュー機能

9.3 技術スタック
フロントエンド

React (UIフレームワーク)
Tailwind CSS (スタイリング)
React Flow または mermaid (フロー図)
Papa Parse (CSV解析)
SheetJS (xlsx) (Excel読み書き)

データ永続化（推奨）

LocalStorage (初期段階)
IndexedDB (大量データ対応)
または Backend API + Database（将来的な拡張）

9.4 UI構成
┌─────────────────────────────────────────────────┐
│  REQUISITION Generator - Phase 1 MVP            │
├─────────────────────────────────────────────────┤
│                                                 │
│  【ステップ1: プロジェクト基本情報】             │
│  ┌───────────────────────────────────────┐      │
│  │ プロジェクトID: [自動生成]             │      │
│  │ プロジェクト名: [____________]         │      │
│  │ 顧客名: [____________]                 │      │
│  │ ショップ: [溶接 ▼]                    │      │
│  │ ライン名称: [____________]             │      │
│  │ 納期: [____/__/__]                     │      │
│  │ 担当PM: [____________]                 │      │
│  └───────────────────────────────────────┘      │
│                                                 │
│  【ステップ2: 機器リスト作成】                   │
│  ┌───────────────────────────────────────┐      │
│  │ [📥 Excelテンプレートダウンロード]    │      │
│  │                                       │      │
│  │ [📤 Excelファイルをアップロード]      │      │
│  │    (ファイル選択またはドラッグ&ドロップ) │      │
│  └───────────────────────────────────────┘      │
│                                                 │
│  【ステップ3: 機器番号採番設定】                 │
│  ┌───────────────────────────────────────┐      │
│  │ プレフィックス: [BS-] (オプション)     │      │
│  │ 開始番号: [001▼]                       │      │
│  │                                       │      │
│  │ [🔢 自動採番実行]                      │      │
│  └───────────────────────────────────────┘      │
│                                                 │
│  【ステップ4: 機器リスト確認＆編集】             │
│  ┌───────────────────────────────────────┐      │
│  │ 機器番号 | 工程 | 機能 | 種別 | 名称... │      │
│  │─────────────────────────────────────│      │
│  │ BS-WRB-001 | 010 | GEO溶接 | WRB | ...│ [編集]│
│  │ BS-WGN-001 | 010 | GEO溶接 | WGN | ...│ [編集]│
│  │ BS-HRB-001 | 010 | GEO溶接 | HRB | ...│ [編集]│
│  │ ...                                   │      │
│  └───────────────────────────────────────┘      │
│                                                 │
│  【ステップ5: フロー図作成】                     │
│  ┌───────────────────────────────────────┐      │
│  │ Mermaid記法入力:                      │      │
│  │ ┌─────────────────────────────────┐  │      │
│  │ │ graph LR                        │  │      │
│  │ │   A[#010 Sidebody GEO溶接]      │  │      │
│  │ │   --> B[#020 Door RESPOT]       │  │      │
│  │ └─────────────────────────────────┘  │      │
│  │                                       │      │
│  │ プレビュー:                           │      │
│  │ [フロー図がここに表示される]          │      │
│  └───────────────────────────────────────┘      │
│                                                 │
│  【ステップ6: REQUISITION生成】                  │
│  ┌───────────────────────────────────────┐      │
│  │ [📄 プレビュー表示]                   │      │
│  │ [💾 HTML/Markdownダウンロード]        │      │
│  └───────────────────────────────────────┘      │
│                                                 │
└─────────────────────────────────────────────────┘
10. 今後の拡張（Phase 2以降）
Phase 2: 機能拡張

採番ルールカスタマイズUI
Webベースビジュアルエディタ（React Flow等）
Word/PDF出力機能
より高度な機器リスト編集UI

Phase 3: 統合・自動化

n8nワークフロー統合
進捗管理ダッシュボード
外部システム連携（CAD、ERP等）
承認フロー機能

11. 実装優先順位
最優先（MVP）

Excelテンプレート生成・ダウンロード
Excelアップロード＆解析
機器番号自動採番
機器リスト表示

次優先

機器番号手動編集UI
mermaidフロー図エディタ
簡易REQUISITION生成（HTML）

将来対応

Word/PDF出力
n8nワークフロー連携
外部システム統合


12. 開発開始時のアクション
12.1 最初に実装するもの
Excelテンプレート＆アップロード機能

Excelテンプレートファイル（.xlsx）の生成
Excelアップロード機能
データ解析＆表示
自動採番ロジック

12.2 使用ライブラリ
json{
  "dependencies": {
    "react": "^18.x",
    "react-dom": "^18.x",
    "xlsx": "^0.18.x",
    "papaparse": "^5.x",
    "mermaid": "^10.x",
    "tailwindcss": "^3.x"
  }
}
12.3 ディレクトリ構成（案）
requisition-generator/
├── public/
├── src/
│   ├── components/
│   │   ├── ProjectInfoForm.jsx
│   │   ├── ExcelUploader.jsx
│   │   ├── NumberingConfig.jsx
│   │   ├── EquipmentList.jsx
│   │   ├── FlowDiagramEditor.jsx
│   │   └── RequisitionPreview.jsx
│   ├── utils/
│   │   ├── excelParser.js
│   │   ├── numberingEngine.js
│   │   ├── equipmentTypesData.js
│   │   └── requisitionGenerator.js
│   ├── App.jsx
│   └── main.jsx
├── package.json
└── README.md